#{this_is_a_page_for_logged_in_zeugnis_admins}
#{File.read('/static/_tresor_public_template.html')}
<div class='container bg-white'>
    <div class="w-full">
        <h3>Zeugnis√ºbersicht #{ZEUGNIS_SCHULJAHR.sub('_', '/')} (#{ZEUGNIS_HALBJAHR}. Halbjahr)</h3>
        <div id="data-here"></div>
    </div>
</div>

<script>
var ZEUGNIS_SCHULJAHR = "#{ZEUGNIS_SCHULJAHR}";
var ZEUGNIS_HALBJAHR = "#{ZEUGNIS_HALBJAHR}";
var zeugnis_klassen_order = #{ZEUGNIS_KLASSEN_ORDER.to_json};
var klassen_tr = #{KLASSEN_TR.to_json};
var zeugnisliste_for_klasse = #{@@zeugnisliste_for_klasse.to_json};

window.addEventListener('load', function () {
    let path_arrays = [];
    for (let klasse of zeugnis_klassen_order) {
        $('#data-here').append($(`<h4>`).text(`Klasse ${klassen_tr[klasse] ?? klasse}`));
        let path_array = [];
        path_array.push(['Schuljahr', ZEUGNIS_SCHULJAHR]);
        path_array.push(['Halbjahr', ZEUGNIS_HALBJAHR]);
        let liste = zeugnisliste_for_klasse[klasse];
        let faecher = liste.faecher;
        let faecher_for_paths = [];
        for (let fach of faecher) {
            faecher_for_paths.push(fach);
            if (FAECHER_SPRACHEN.indexOf(fach) >= 0) {
                faecher_for_paths.push(`${fach}_AT`);
                faecher_for_paths.push(`${fach}_SL`);
            }
        }
        let emails = liste.schueler.map(function(x) { return x.email; });
        path_array.push(['Fach', faecher_for_paths]);
        path_array.push(['Email', emails]);
        path_arrays.push(path_array);
    }
    tresor_api_call('/jwt/get_many', {path_arrays: path_arrays, key: 'Wert'}, function(data) {
        console.log(data);
    });
    return;

});
</script>